---
title: "DATA605 - Assignment 11"
author: "Nick Oliver"
output:
  pdf_document:
    latex_engine: xelatex
    extra_dependencies: ["geometry", "multicol", "multirow"]
editor_options: 
  chunk_output_type: console
---

# Assignment 11

## Question

Using the “cars” dataset in R, build a linear model for stopping distance as a function of speed and replicate the analysis of your textbook chapter 3 (visualization, quality evaluation of the model, and residual analysis.)

## Solution

Loaded the `tidyverse` library
```{r, echo=FALSE, message=FALSE}
library(tidyverse)
```
View the data set to find the column names
```{r}
glimpse(cars)
```
Use the `lm` function to fit a linear regression model
```{r}
model <- lm(data = cars, dist ~ speed)
model
```

The function to predict the stopping distance is $StoppingDistinace = -17.579  + 3.932 \times speed$

### Visualizing the data

As the text does you can use the buil-in plot function to plot the scatter plot then add the regression line from generated by the `lm` function using `abline`
```{r}
plot(cars)
abline(model)
```

You can also use `ggplot` to plot the scatter plot of speed vs stopping distance. Use `stat_smooth` to add a linear fitted line to the plot representing a linear regression model.
```{r}
cars %>% ggplot(aes(x = speed, y = dist)) +
  geom_point() +
  stat_smooth(method = "lm", se = T) +
  xlab('Speed') +
  ylab('Stopping Distance')
```

### Evaluating the quality of the model

```{r}
summary(model)
```

Standard error at least five times to ten times smaller than corresponding coefficients?
$3.9324 / 0.4155 \approx 9.464$ Yes it is about 9 times smaller

The value of 1.49e-12 and the `***` on the p-value of speed indicates high significance of the speed or to put it another way an extremely low probability that the speed is not a good predictor of stopping distance. A 0.0123 value for the intercept indicates a very low probability that the intercept is not relevant as well.

$R^2$ of 0.6511 indicates a good fitting model as it is relatively close to one.

### Residual Analysis

```{r}
plot(fitted(model), resid(model))
```

Plotting the residuals vs. the input values does not show any obvious patterns which indicates that the variables used are sufficient to explain the relationship in the model.

```{r}
qqnorm(resid(model))
qqline(resid(model))
```

We should expect to see the residuals follow a straight line but at the beginning and most certainly near the end the do not follow a straight line. This shows that the residuals may not be normally distributed.

Plotting a histogram of the residuals shows similar results.

This indicates there may be better construct a model the produces better predictions with tighter residual values. 
```{r}
ggplot(data = cars, aes(x = model$residuals)) +
    geom_histogram(fill = 'steelblue', color = 'black', binwidth = 3) +
    labs(title = 'Histogram of Residuals', x = 'Residuals', y = 'Frequency')
```