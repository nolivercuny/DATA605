---
output:
  prettydoc::html_pretty:
    theme: hpstr
    highlight: github
editor_options: 
  chunk_output_type: console
---

# Discussion 11

## Student Data

```{r, echo=FALSE, message=FALSE}
library(tidyverse)
library(kableExtra)
```

```{r}
df <- read.csv('https://raw.githubusercontent.com/nolivercuny/DATA605/main/week%2011/data/student_data.csv')
```

```{r}
df <- df %>%
  mutate(studyMinsSum = rowSums(select(df,2:226),na.rm = T)) %>%
  select(c(username,
           studyMinsSum,starts_with("Unit.1.Quiz") |
             starts_with("Unit.2.Quiz") |
             starts_with("Unit.3.Quiz")))
df <- df %>%
  mutate(quizMean = rowMeans(select(df,3:5),na.rm=T))
```

```{r}
plot(df$quizMean ~ df$studyMinsSum, main="Effort vs. Scores",
xlab="Total Work Time (m)", ylab="Mean Quiz Score")
df %>% 
  filter(!grepl("instructor",username)) %>%
  kable()
```
```{r, warning=FALSE}
model <- lm(df$quizMean ~ df$studyMinsSum)
summary(model)
ggplot(data = df, aes(x = studyMinsSum, y = quizMean)) +
  geom_point() +
  stat_smooth(method = "lm", se = FALSE)
```